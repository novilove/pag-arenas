<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arena Hey!</title>
    <link rel="stylesheet" href="../css/styles.css" />

    <link rel="stylesheet" href="../css/grid.css" />
    <link rel="stylesheet" href="../css/spacing-utilities.css" />
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/navbar.css" />
    <link rel="stylesheet" href="../css/carrusel.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wdth,wght@0,75..100,300..800;1,75..100,300..800&display=swap"
      rel="stylesheet"
    />
    <style>
      /* styles.css */
      :root {
        --light: #f0c41d;
        --dark: #ea527e;
        --text-light-100: #fafafa;
      }
      .line-color-marca {
        background: var(--dark);
        opacity: 0.9;
      }
      /* Asegúrate de que estos bloques tengan tamaño */
      .title-fondo-marca,
      .product-img,
      .img-description,
      .arena,
      .cat-1,
      .fondo-cat {
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }

      /* Alturas y anchos mínimos para que se vea */
      .title-fondo-marca {
        width: 100%;
        object-fit: contain;
        height: 33rem;
        overflow: hidden;
        background-position: bottom;
      }

      .product-img {
        background-size: contain !important;

        width: 85%;
        position: absolute;
        top: 0;
        height: 33rem;
        overflow: hidden;
      }
      .img-description {
        width: 100%;
        height: 4rem;
        margin-top: 2rem;
        background-size: contain;
      }
      .arena {
        margin-top: 2rem;

        width: 100%;
        background-size: contain;
        height: 25rem;
        z-index: 2 !important;
        background-position: right;
      }
      .cat-1 {
        background-size: contain;
        width: 100%;
        background-position: right;
        height: 36rem;
        /*         margin-top: -10rem; */
        z-index: 3 !important;
      }
      .fondo-cat {
        width: 100%;
        height: 48rem;
        background-size: contain;
        position: absolute;
        z-index: 1 !important;
      }

      /* Contenedor principal */
      .chat-container {
        display: flex;
        flex-direction: column;
        justify-self: center;
        gap: 1rem;
        width: 50%;
        margin-top: 10rem;
      }
      @media (max-width: 767px) {
        .chat-container {
          width: 90%;
          margin-top: 2rem;
        }
      }

      .chat-container .left {
        align-self: flex-end;
        text-align: end;
        width: fit-content;
      }

      .chat-container .right {
        align-self: flex-start;
        text-align: start;
        width: fit-content;
      }

      /* Burbuja base */
      .chat-bubble {
        position: relative;
        padding: 1.2rem 1.6rem;
        border-radius: 24px;
        color: white;
        font-size: 1rem;
        max-width: 100%;
        font-weight: 100;
        word-wrap: break-word;
      }

      /* Temas */
      .light {
        background-color: var(--light);
        color: white;
      }

      .dark {
        background-color: var(--dark);
      }

      /* Lado izquierdo */
      .chat-bubble.right::after {
        content: "";
        position: absolute;
        left: 2rem;
        bottom: -10px;
        width: 0;
        height: 0;
        border: 10px solid transparent;
        border-top-color: var(--light);
        border-bottom: 0;
        margin-left: -5px;
      }

      /* Lado derecho */
      .chat-bubble.left::after {
        content: "";
        position: absolute;
        right: 2rem;
        bottom: -10px;
        width: 0;
        height: 0;
        border: 10px solid transparent;
        border-top-color: var(--dark);
        border-bottom: 0;
        /*        color: var(--text-light-100); */
        margin-right: -5px;
      }
      .brand-row {
        display: flex;
        justify-content: space-evenly;
        margin-top: 3rem;
        margin: 5rem;
      }
      .brand-row img {
        width: 200px;
        height: auto;
        cursor: pointer;
        opacity: 0.6;
        transition: opacity 0.3s ease, width 0.3s ease;
      }

      .brand-row img:not(:hover) {
        opacity: 1;
      }
      .brand-row img:hover {
        width: 215px;
        opacity: 1;
      }

      .list-kg {
        align-self: stretch;
        justify-content: start;
        align-items: center;
        display: inline-flex;
      }
      /* Responsividad */
      @media (max-width: 767px) {
        .brand-row img {
          width: 100px;
          margin: 1rem;
        }
        .brand-row {
          margin: 0rem;
        }
        .chat-bubble {
          font-size: 0.95rem;
          padding: 1rem 1.2rem;
        }
        .list-kg {
          justify-content: space-evenly;
        }
      }

      @media (min-width: 768px) {
        .chat-bubble {
          font-size: 1.1rem;
          padding: 1.2rem 1.6rem;
        }
      }
      .chat-bubble {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }

      .chat-bubble.show {
        opacity: 1;
        transform: translateY(0);
      }
      .hidden-until-end {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 1s ease, transform 1s ease;
      }

      .hidden-until-end.show {
        opacity: 1;
        transform: translateY(0);
      }
      #cat-image {
        position: relative;
        z-index: 10;
      }

      #fondo-home {
        position: relative;
        z-index: 1;
      }
      /*  */

      .color-primary-marca {
        background: var(--dark);
        color: #fafafa;
      }
    </style>
  </head>
  <body>
    <div class="fondo">
      <div
        id="navbar-placeholder"
        style="
          position: sticky !important;
          top: 0;
          z-index: 999;
          overflow: hidden;
        "
      ></div>
      <!-- TITLE DESCRIPTION PRODUCT -->
      <div class="title-fondo-marca row">
        <div
          style="
            align-self: stretch;
            flex-direction: column;
            justify-content: start;
            display: flex;
          "
          class="col-md-5 col-sm-12"
        >
          <h2 class="gotham white" id="title-fondo-marca">
            Hey! Arena de<br />bentonita natural <br />Aroma lavanda
          </h2>
          <div id="list-kg" class="list-kg mr-4">
            <h3 class="gotham white">3kg</h3>
            <h3 class="gotham white">4kg</h3>
            <h3 class="gotham white">10kg</h3>
            <h3 class="gotham white">20kg</h3>
          </div>
          <h4 class="gotham white" id="description-fondo-marca">
            Esta arena está especialmente formulada para neutralizar rápidamente
            los olores y es de bajo rastreo, por lo que hay menos suciedad y no
            hay rastros de arena esparcida.
          </h4>
        </div>
        <div
          class="col-md-5 col-sm-12 mt-2"
          style="display: flex; justify-content: center; align-content: end"
        >
          <div class="product-img"></div>
        </div>
      </div>
      <!-- picture decription -->
      <div class="row col-md-12 not-p-x">
        <div class="col-md-7 img-description px-2 py-2 mb-2"></div>
        <div
          class="col-md-7 color-primary-marca px-2"
          style="border-bottom-right-radius: 100rem"
        >
          <h3
            class="gotham white-banner my-0 text-center"
            id="description-marca-text"
          >
            Aglutinación superior y con un agradable aroma a lavanda.
          </h3>
        </div>
      </div>
      <div class="row" style="position: relative">
        <div class="row col-md-6 arena" style="justify-content: center"></div>

        <div class="d-center row col-md-6 cat-1"></div>
        <div class="d-center row col-md-12 col-sm-0 under-sand">
          <h3 class="gotham white-sand w-100 pb-0" id="cat-image-text-1">
            Ideal para todo<br />tipo de areneros
          </h3>
          <h4 class="gotham white-sand w-100 pt-0" id="cat-image-text-2">
            y es muy eficaz en hogares<br />con varios gatos.
          </h4>
        </div>
        <div class="fondo-cat"></div>
        <div class="d-center row col-md-0 col-sm-12 my-auto" style="z-index: 4">
          <h3
            class="gotham white-sand w-100 py-0 pt-2 text-center line-color-marca"
            id="cat-image-text-3"
          >
            Ideal para todo<br />tipo de areneros
          </h3>
          <h4
            class="gotham white-sand w-100 pt-0 pb-2 text-center line-color-marca"
            id="cat-image-text-4"
          >
            y es muy eficaz en hogares<br />con varios gatos.
          </h4>
        </div>
      </div>

      <!-- >>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< -->

      <!-- CHATTTTT -->
      <main class="chat-container col-md-10" id="chat-container"></main>
      <!-- >>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< -->

      <!-- VIDEO -->
      <div class="video-carousel mt-4">
        <div class="video-wrapper" id="video-wrapper">
          <!--   <video
            id="carouselVideo"
            class="carousel-video"
            controls=""
            muted=""
            preload="metadata"
            src="https://stalwart-faloodeh-22bebe.netlify.app/public/assets/video/hey-basica.mp4"
          ></video> -->
        </div>
      </div>

      <div class="col-sm-12 col-md-12 mt-4 hero-content cate">
        <h2 class="my-0">Más <strong>Arenas...</strong></h2>
      </div>
      <div id="brand-row" class="brand-row">
        <!--  <a href="/views/item-marca.html?brand=pipicat&category=premium">
          <img
            src="https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/marcas/web/pipicat/premium.svg"
            alt="gatuna"
        /></a>
        <a href="/views/item-marca.html?brand=gatuna&category=premium">
          <img
            src="https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/marcas/web/gatuna/premium.svg"
            alt="london"
            class="active"
          />
        </a>
        <a href="/views/item-marca.html?brand=london&category=basica">
          <img
            src="https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/marcas/web/london/basica.svg"
            alt="pipicat"
          />
        </a> -->
      </div>
      <div id="topbar-placeholder"></div>
    </div>
    <!--  -->
    <!-- JS -->
    <!--  -->
    <script type="module" src="../javascript/content-replace.js"></script>

    <script type="module">
      import { addComponent, addNavFunc } from "../javascript/addComponents.js";

      // Espera a que el DOM esté completamente cargado antes de ejecutar el script
      document.addEventListener("DOMContentLoaded", async () => {
        await addComponent("navbar-placeholder", "../components/navbar.html");
        addNavFunc();
        addComponent("topbar-placeholder", "../components/footer.html");

        const container = document.querySelector(".chat-container");
        const bubbles = Array.from(container.querySelectorAll(".chat-bubble"));
        let alreadyTriggered = false;

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting && !alreadyTriggered) {
                alreadyTriggered = true;

                bubbles.forEach((bubble, index) => {
                  setTimeout(() => {
                    bubble.classList.add("show");
                    if (index === bubbles.length - 1) {
                      const extraElements = [
                        document.getElementById("cat-image"),
                        document.getElementById("fondo-home"),
                      ];

                      setTimeout(() => {
                        extraElements.forEach((el) => el.classList.add("show"));
                      }, 500); // Espera un segundo después de la última burbuja
                    }
                  }, index * 500); // 500ms entre burbujas
                });

                observer.unobserve(container); // Se ejecuta solo una vez
              }
            });
          },
          {
            threshold: 0.2, // cuando 20% del contenedor sea visible
          }
        );

        observer.observe(container);
      });
      // content-replace.js

      const BRAND_PATH =
        "https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/marcas/logos";
      const MOBILE_PATH =
        "https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/marcas/web";
      const WEB_PATH =
        "https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/marcas/web";

      // Mapea clases a nombres de archivo
      const PARTS = {
        "title-fondo-marca": "title-fondo-marca.svg",
        "product-img": "product-img.svg",
        "img-description": "img-description.svg",
        arena: "img-arena.svg",
        "cat-1": "cat-marca.svg",
        "fondo-cat": "fondo-cat.svg",
      };

      const BREAK = 767;
      function isMobile() {
        return window.innerWidth <= BREAK;
      }

      function getParam(name, def) {
        const p = new URLSearchParams(window.location.search);
        return p.get(name) || def;
      }

      // Comprueba existencia de URL sin CORS
      function imageExists(url) {
        return new Promise((res) => {
          const i = new Image();
          i.src = url;
          i.onload = () => res(true);
          i.onerror = () => res(false);
        });
      }

      async function replaceContent() {
        const brand = getParam("brand", "london");
        const category = getParam("category", "basica");
        const basePath =
          (isMobile() ? MOBILE_PATH : WEB_PATH) + `/${brand}/${category}`;

        for (const cls in PARTS) {
          const file = PARTS[cls];
          const url = `${basePath}/${file}`;
          if (await imageExists(url)) {
            document.querySelectorAll(`.${cls}`).forEach((el) => {
              el.style.backgroundImage = `url('${url}')`;
            });
          }
        }
      }

      window.addEventListener("DOMContentLoaded", replaceContent);
      window.addEventListener("resize", () => {
        clearTimeout(window._cr);
        window._cr = setTimeout(replaceContent, 200);
      });
    </script>
  </body>
</html>
