<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hablemos de arenas</title>
    <link rel="stylesheet" href="../css/styles.css" />

    <link rel="stylesheet" href="../css/grid.css" />
    <link rel="stylesheet" href="../css/spacing-utilities.css" />
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/navbar.css" />
    <link rel="stylesheet" href="../css/carrusel.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wdth,wght@0,75..100,300..800;1,75..100,300..800&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Contenedor principal */
      .chat-container {
        display: flex;
        flex-direction: column;
        justify-self: center;
        gap: 0.5rem;
        width: 50%;
      }
      @media (max-width: 767px) {
        .chat-container {
          width: 90%;
        }
      }

      .chat-container .left {
        align-self: flex-end;
        text-align: end;
        width: fit-content;
      }

      .chat-container .right {
        align-self: flex-start;
        text-align: start;
        width: fit-content;
      }

      /* Burbuja base */
      .chat-bubble {
        position: relative;
        padding: 1.2rem 1.6rem;
        border-radius: 24px;
        color: white;
        font-size: 1rem;
        max-width: 100%;
        word-wrap: break-word;
      }

      /* Temas */
      .light {
        background-color: #c1d100;
        color: white;
      }

      .dark {
        background-color: #73a121;
      }

      /* Lado izquierdo */
      .chat-bubble.right::after {
        content: "";
        position: absolute;
        left: 2rem;
        bottom: -10px;
        width: 0;
        height: 0;
        border: 10px solid transparent;
        border-top-color: #c1d100;
        border-bottom: 0;
        margin-left: -5px;
      }

      /* Lado derecho */
      .chat-bubble.left::after {
        content: "";
        position: absolute;
        right: 2rem;
        bottom: -10px;
        width: 0;
        height: 0;
        border: 10px solid transparent;
        border-top-color: #73a121;
        border-bottom: 0;
        margin-right: -5px;
      }

      /* Responsividad */
      @media (max-width: 767px) {
        .chat-bubble {
          font-size: 0.95rem;
          padding: 1rem 1.2rem;
        }
      }

      @media (min-width: 768px) {
        .chat-bubble {
          font-size: 1.1rem;
          padding: 1.2rem 1.6rem;
        }
      }
      .chat-bubble {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }

      .chat-bubble.show {
        opacity: 1;
        transform: translateY(0);
      }
      .hidden-until-end {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 1s ease, transform 1s ease;
      }

      .hidden-until-end.show {
        opacity: 1;
        transform: translateY(0);
      }
      #cat-image {
        position: relative;
        z-index: 10;
      }

      #fondo-home {
        position: relative;
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <div class="fondo">
      <div
        id="navbar-placeholder"
        style="
          position: sticky !important;
          top: 0;
          z-index: 999;
          overflow: hidden;
        "
      ></div>
      <div>
        <div class="cola-title" style="margin-top: -3rem"></div>
        <div class="col-sm-12 col-md-12 hero-content cate my-4">
          <h1 class="my-0">¡Hablemos!</h1>
        </div>
      </div>
      <main class="chat-container col-md-10">
        <div class="chat-bubble right col-md-7 light">
          Todas nuestras arenas las podras encontrar <br />
          en las mejores tiendas del país
        </div>

        <div class="chat-bubble left col-md-7 dark">
          <strong>¿No sabes donde comprar?</strong>
        </div>

        <div class="chat-bubble right col-md-7 light">
          Escribanos a contacto@pw.cl o a nuestro <br />
          instagram @petwarehousechile
        </div>

        <div class="chat-bubble left col-md-7 dark">
          <strong
            >¿Tienes una tienda y quieres <br />
            vender nuestras arenas sanitarias?</strong
          >
        </div>
        <div class="chat-bubble right col-md-7 light">
          Llena el siguiente formulario y nos <br />
          contactaremos en la brevedad contigo :) <br /><br />
          <div class="col-sm-12 col-md-12 row d-center">
            <a class="btn-vermas"> Formulario </a>
          </div>
        </div>
      </main>

      <div id="fondo-home" class="fondo-home-4 hidden-until-end">
        <img
          id="cat-image"
          src="https://stalwart-faloodeh-22bebe.netlify.app/public/assets/svg/hablemos/cat-hablemos.svg"
          width="75%"
          class="hidden-until-end"
        />
      </div>

      <div id="topbar-placeholder"></div>
    </div>
    <script type="module">
      import { addComponent, addNavFunc } from "../javascript/addComponents.js";

      // Espera a que el DOM esté completamente cargado antes de ejecutar el script
      document.addEventListener("DOMContentLoaded", async () => {
        await addComponent("navbar-placeholder", "../components/navbar.html");
        addNavFunc();
        addComponent("topbar-placeholder", "../components/footer.html");
        const container = document.querySelector(".chat-container");
        const bubbles = Array.from(container.querySelectorAll(".chat-bubble"));
        let alreadyTriggered = false;

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting && !alreadyTriggered) {
                alreadyTriggered = true;

                bubbles.forEach((bubble, index) => {
                  setTimeout(() => {
                    bubble.classList.add("show");
                    if (index === bubbles.length - 1) {
                      const extraElements = [
                        document.getElementById("cat-image"),
                        document.getElementById("fondo-home"),
                      ];

                      setTimeout(() => {
                        extraElements.forEach((el) => el.classList.add("show"));
                      }, 500); // Espera un segundo después de la última burbuja
                    }
                  }, index * 500); // 500ms entre burbujas
                });

                observer.unobserve(container); // Se ejecuta solo una vez
              }
            });
          },
          {
            threshold: 0.2, // cuando 20% del contenedor sea visible
          }
        );

        observer.observe(container);
      });
    </script>
  </body>
</html>
